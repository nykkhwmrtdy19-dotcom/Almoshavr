<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>هوش مصنوعی فارسی</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, sans-serif;
        }
        
        body {
            background: #000;
            height: 100vh;
            overflow: hidden;
        }
        
        .chat-container {
            width: 100%;
            height: 100vh;
            background: #000;
            display: flex;
            flex-direction: column;
        }
        
        .mode-selector {
            padding: 20px;
            background: #000;
            border-bottom: 1px solid #333;
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .mode-btn {
            padding: 15px 30px;
            border: 2px solid #333;
            border-radius: 25px;
            background: #1a1a1a;
            color: #888;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .mode-btn.active {
            background: #10b981;
            color: white;
            border-color: #10b981;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }
        
        .mode-btn:hover {
            border-color: #10b981;
            color: #10b981;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #000;
            display: flex;
            flex-direction: column;
        }
        
        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            justify-content: flex-end;
        }
        
        .bot-message {
            justify-content: flex-start;
        }
        
        .message-bubble {
            max-width: 80%;
            padding: 15px 20px;
            border-radius: 20px;
            font-size: 16px;
            line-height: 1.6;
            word-wrap: break-word;
        }
        
        .user-message .message-bubble {
            background: #10b981;
            color: white;
            border-bottom-right-radius: 8px;
        }
        
        .bot-message .message-bubble {
            background: #1a1a1a;
            color: white;
            border-bottom-left-radius: 8px;
            border: 1px solid #333;
        }
        
        .code-block {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 12px;
            margin: 10px 0;
            border-left: 4px solid #10b981;
            direction: ltr;
            text-align: left;
            position: relative;
            border: 1px solid #333;
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #10b981;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .copy-btn:hover {
            background: #0da271;
        }
        
        .copy-btn.copied {
            background: #059669;
        }
        
        .code-content {
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            white-space: pre-wrap;
            color: #e5e7eb;
        }
        
        .typing-indicator {
            display: none;
            padding: 15px 20px;
            background: #1a1a1a;
            border-radius: 20px;
            border-bottom-left-radius: 8px;
            margin-bottom: 15px;
            align-items: center;
            max-width: 70px;
            border: 1px solid #333;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.4; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        .chat-input-container {
            padding: 20px;
            background: #000;
            border-top: 1px solid #333;
            display: flex;
            gap: 12px;
        }
        
        .chat-input {
            flex: 1;
            padding: 16px 20px;
            border: 1px solid #333;
            border-radius: 25px;
            outline: none;
            font-size: 16px;
            background: #1a1a1a;
            color: white;
            transition: all 0.2s ease;
        }
        
        .chat-input:focus {
            border-color: #10b981;
            background: #1a1a1a;
        }
        
        .chat-input::placeholder {
            color: #666;
        }
        
        .send-button {
            background: #10b981;
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.2s ease;
            min-width: 70px;
        }
        
        .send-button:hover {
            background: #0da271;
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background: #10b981;
            border-radius: 3px;
        }

        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }
        
        .mode-btn.active {
            animation: pulse-green 2s infinite;
        }

        @media (max-width: 768px) {
            .mode-selector {
                padding: 15px;
            }
            
            .mode-btn {
                padding: 12px 24px;
                font-size: 14px;
            }
            
            .chat-messages {
                padding: 15px;
            }
            
            .message-bubble {
                max-width: 85%;
                padding: 12px 16px;
                font-size: 15px;
            }
            
            .chat-input-container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="mode-selector">
            <button class="mode-btn active" onclick="setMode('programming')">برنامه نویسی</button>
            <button class="mode-btn" onclick="setMode('general')">اطلاعات عمومی</button>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <!-- صفحه کاملاً خالی -->
        </div>
        
        <div class="typing-indicator" id="typingIndicator">
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>
        
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" 
                   placeholder="هر سوالی دارید بپرسید..." 
                   onkeypress="handleKeyPress(event)">
            <button class="send-button" onclick="sendMessage()">ارسال</button>
        </div>
    </div>

    <script>
        // سیستم هوش مصنوعی پیشرفته - بدون کلیدواژه ثابت
        let currentMode = 'programming';
        let isTyping = false;

        // سیستم درک و پردازش سوال کاربر
        function understandAndRespond(userMessage) {
            const message = userMessage.toLowerCase().trim();
            
            // تشخیص موضوع سوال
            const topic = detectTopic(message);
            const intent = detectIntent(message);
            const context = analyzeContext(message);
            
            // تولید پاسخ هوشمند بر اساس موضوع و زمینه
            return generateIntelligentResponse(topic, intent, context, userMessage);
        }

        // تشخیص موضوع سوال
        function detectTopic(message) {
            const topics = {
                programming: [
                    'جاوااسکریپت', 'پایتون', 'جاوا', 'سی پلاس', 'html', 'css', 'react',
                    'vue', 'angular', 'node', 'php', 'sql', 'دیتابیس', 'الگوریتم',
                    'برنامه', 'کد', 'فانکشن', 'کلاس', 'شی', 'آرایه', 'متد', 'کامپوننت',
                    'فریمورک', 'کتابخانه', 'بک اند', 'فرانت اند', 'توسعه', 'دیباگ'
                ],
                general: [
                    'تاریخ', 'جغرافیا', 'علم', 'فرهنگ', 'ادبیات', 'هنر', 'سیاست',
                    'اقتصاد', 'ورزش', 'سلامتی', 'طبیعت', 'حیوانات', 'گیاهان', 'فضا',
                    'نجوم', 'فیزیک', 'شیمی', 'زیست', 'ریاضی', 'پزشکی', 'تکنولوژی'
                ]
            };

            // تشخیص موضوع بر اساس کلمات موجود در سوال
            for (const [category, words] of Object.entries(topics)) {
                for (const word of words) {
                    if (message.includes(word.toLowerCase())) {
                        return { category, specificTopic: word };
                    }
                }
            }

            return { category: 'general', specificTopic: 'سوال عمومی' };
        }

        // تشخیص هدف کاربر از سوال
        function detectIntent(message) {
            if (message.includes('چیست') || message.includes('چه') || message.includes('معنی')) {
                return 'تعریف';
            } else if (message.includes('چگونه') || message.includes('چطوری') || message.includes('روش')) {
                return 'آموزش';
            } else if (message.includes('مقایسه') || message.includes('فرق')) {
                return 'مقایسه';
            } else if (message.includes('مزایا') || message.includes('معایب')) {
                return 'تحلیل';
            } else if (message.includes('مثال') || message.includes('نمونه')) {
                return 'مثال';
            } else {
                return 'توضیح';
            }
        }

        // تحلیل زمینه سوال
        function analyzeContext(message) {
            const context = {
                hasCodeRequest: message.includes('کد') || message.includes('برنامه') || message.includes('function'),
                noCodeRequest: message.includes('کد نده') || message.includes('بدون کد'),
                needsExample: message.includes('مثال') || message.includes('نمونه'),
                needsComparison: message.includes('مقایسه') || message.includes('فرق'),
                isTechnical: message.includes('چگونه') || message.includes('طراحی') || message.includes('پیاده')
            };
            return context;
        }

        // تولید پاسخ هوشمند
        function generateIntelligentResponse(topic, intent, context, originalMessage) {
            let response = '';
            
            // تولید پاسخ بر اساس موضوع و هدف
            switch (intent) {
                case 'تعریف':
                    response = generateDefinitionResponse(topic, context);
                    break;
                case 'آموزش':
                    response = generateTutorialResponse(topic, context);
                    break;
                case 'مقایسه':
                    response = generateComparisonResponse(topic, context);
                    break;
                case 'تحلیل':
                    response = generateAnalysisResponse(topic, context);
                    break;
                case 'مثال':
                    response = generateExampleResponse(topic, context);
                    break;
                default:
                    response = generateExplanationResponse(topic, context, originalMessage);
            }

            // اضافه کردن کد در صورت درخواست و عدم منع
            if (context.hasCodeRequest && !context.noCodeRequest && currentMode === 'programming') {
                response += '\n\n' + generateCodeExample(topic, intent);
            }

            return {
                text: response,
                type: (context.hasCodeRequest && !context.noCodeRequest) ? 'code' : 'text'
            };
        }

        // تولید پاسخ تعریفی
        function generateDefinitionResponse(topic, context) {
            const definitions = {
                'جاوااسکریپت': 'جاوااسکریپت یک زبان برنامه‌نویسی سطح بالا، پویا و مفسری است که عمدتاً برای توسعه وب استفاده می‌شود. این زبان هم در سمت کلاینت و هم در سمت سرور قابل استفاده است.',
                'پایتون': 'پایتون یک زبان برنامه‌نویسی سطح بالا، همه‌منظوره و مفسری است که برای خوانایی و سادگی طراحی شده است. در حوزه‌های مختلفی از جمله هوش مصنوعی، علم داده و توسعه وب استفاده می‌شود.',
                'react': 'React یک کتابخانه جاوااسکریپت برای ساخت رابط‌های کاربری است که توسط فیسبوک توسعه یافته است. از کامپوننت‌های قابل استفاده مجدد و Virtual DOM استفاده می‌کند.',
                'تاریخ': 'تاریخ مطالعه وقایع گذشته و تحلیل تأثیر آنها بر حال و آینده است. تاریخ به ما کمک می‌کند تا ریشه‌های فرهنگی، اجتماعی و سیاسی جوامع را درک کنیم.',
                'جغرافیا': 'جغرافیا علم مطالعه زمین، محیط‌های طبیعی، جوامع انسانی و روابط متقابل آنهاست. این علم به درک بهتر جهان و چالش‌های محیطی کمک می‌کند.'
            };

            return definitions[topic.specificTopic] || `منظور شما از "${topic.specificTopic}" چیست؟ می‌توانید سوال خود را دقیق‌تر بیان کنید.`;
        }

        // تولید پاسخ آموزشی
        function generateTutorialResponse(topic, context) {
            const tutorials = {
                'جاوااسکریپت': 'برای شروع یادگیری جاوااسکریپت، ابتدا با مفاهیم پایه مانند متغیرها، توابع و حلقه‌ها آشنا شوید. سپس DOM manipulation و رویدادها را یاد بگیرید.',
                'پایتون': 'پایتون با syntax ساده‌اش برای مبتدیان عالی است. با انواع داده‌ها، ساختارهای کنترل و توابع شروع کنید، سپس به سراغ مفاهیم پیشرفته‌تر بروید.',
                'react': 'برای یادگیری React ابتدا با JSX و کامپوننت‌ها آشنا شوید. سپس state و props را یاد بگیرید و در نهایت به سراغ hooks و routing بروید.'
            };

            return tutorials[topic.specificTopic] || `برای یادگیری ${topic.specificTopic}، پیشنهاد می‌کنم با مفاهیم پایه شروع کنید و به تدریج به مباحث پیشرفته‌تر برسید.`;
        }

        // تولید پاسخ تحلیلی
        function generateAnalysisResponse(topic, context) {
            return `در تحلیل ${topic.specificTopic} باید جوانب مختلفی را در نظر گرفت. مزایا و معایب آن بستگی به زمینه استفاده و نیازهای خاص شما دارد.`;
        }

        // تولید پاسخ مقایسه‌ای
        function generateComparisonResponse(topic, context) {
            return `برای مقایسه ${topic.specificTopic} با سایر موارد مشابه، باید معیارهای مختلفی مانند کارایی، سهولت استفاده، جامعه کاربری و موارد استفاده را در نظر گرفت.`;
        }

        // تولید پاسخ مثالی
        function generateExampleResponse(topic, context) {
            return `در ادامه یک مثال کاربردی از ${topic.specificTopic} ارائه می‌دهم:`;
        }

        // تولید پاسخ توضیحی
        function generateExplanationResponse(topic, context, originalMessage) {
            return `سوال خوبی پرسیدید! ${topic.specificTopic} موضوع جالبی است که می‌توانم در مورد آن توضیح دهم. آیا می‌خواهید جزئیات بیشتری بدانید؟`;
        }

        // تولید مثال کد
        function generateCodeExample(topic, intent) {
            const codeExamples = {
                'جاوااسکریپت': `// مثال ساده جاوااسکریپت
function greet(name) {
    return 'سلام ' + name + '!';
}

console.log(greet('کاربر'));`,
                'پایتون': `# مثال ساده پایتون
def greet(name):
    return f"سلام {name}!"

print(greet("کاربر"))`,
                'react': `// مثال کامپوننت React
import React from 'react';

function Welcome(props) {
    return <h1>سلام, {props.name}</h1>;
}

export default Welcome;`
            };

            return '```\n' + (codeExamples[topic.specificTopic] || '// کد مثال') + '\n```';
        }

        // سیستم نمایش پیام‌ها
        function addMessage(message, isUser = false, responseData = null) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            
            const bubble = document.createElement('div');
            bubble.className = 'message-bubble';
            
            if (isUser) {
                bubble.textContent = message;
                messageDiv.appendChild(bubble);
                chatMessages.appendChild(messageDiv);
            } else {
                if (responseData && responseData.type === 'code') {
                    bubble.innerHTML = formatCodeMessage(responseData.text);
                    messageDiv.appendChild(bubble);
                    chatMessages.appendChild(messageDiv);
                    
                    setTimeout(() => {
                        addCopyButtons();
                    }, 100);
                } else {
                    const text = responseData ? responseData.text : message;
                    messageDiv.appendChild(bubble);
                    chatMessages.appendChild(messageDiv);
                    typeText(bubble, text);
                }
            }
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function formatCodeMessage(message) {
            const parts = message.split('```');
            let formatted = '';
            
            for (let i = 0; i < parts.length; i++) {
                if (i % 2 === 0) {
                    formatted += parts[i].replace(/\n/g, '<br>');
                } else {
                    formatted += `<div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">کپی کد</button>
                        <div class="code-content">${escapeHtml(parts[i])}</div>
                    </div>`;
                }
            }
            
            return formatted;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function addCopyButtons() {
            document.querySelectorAll('.code-block').forEach(block => {
                if (!block.querySelector('.copy-btn')) {
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn';
                    copyBtn.textContent = 'کپی کد';
                    copyBtn.onclick = function() { copyCode(this); };
                    block.prepend(copyBtn);
                }
            });
        }

        function copyCode(button) {
            const codeBlock = button.parentElement;
            const codeContent = codeBlock.querySelector('.code-content');
            const code = codeContent.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.textContent;
                button.textContent = 'کپی شد!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                button.textContent = 'خطا!';
                setTimeout(() => {
                    button.textContent = 'کپی کد';
                }, 2000);
            });
        }

        function typeText(element, text, speed = 20) {
            if (isTyping) return;
            isTyping = true;
            
            let i = 0;
            element.textContent = '';
            
            function typeChar() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    const chatMessages = document.getElementById('chatMessages');
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    const randomSpeed = speed + Math.random() * 15;
                    setTimeout(typeChar, randomSpeed);
                } else {
                    isTyping = false;
                }
            }
            
            typeChar();
        }

        function setMode(mode) {
            currentMode = mode;
            
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('chatMessages').innerHTML = '';
        }

        function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (message === '') return;
            
            addMessage(message, true);
            chatInput.value = '';
            
            const typingIndicator = document.getElementById('typingIndicator');
            typingIndicator.style.display = 'none';
            
            // تاخیر برای شبیه‌سازی پردازش هوشمند
            const processingTime = 1500 + Math.random() * 2000;
            
            setTimeout(() => {
                const response = understandAndRespond(message);
                typingIndicator.style.display = 'flex';
                
                const typingDelay = 800 + (response.text.length * 3) + Math.random() * 500;
                
                setTimeout(() => {
                    typingIndicator.style.display = 'none';
                    addMessage(null, false, response);
                }, typingDelay);
                
            }, processingTime);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // راه‌اندازی
        document.addEventListener('DOMContentLoaded', function() {
            const chatInput = document.getElementById('chatInput');
            chatInput.focus();
        });
    </script>
</body>
</html>